<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>CardTransactionManager (Calypsonet Terminal Calypso API - 1.7.0-SNAPSHOT)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../../../keyple-stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../../jquery/jquery-3.6.0.min.js"></script>
<script type="text/javascript" src="../../../../../jquery/jquery-ui.min.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="CardTransactionManager (Calypsonet Terminal Calypso API - 1.7.0-SNAPSHOT)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":38,"i1":38,"i2":38,"i3":6,"i4":6,"i5":6,"i6":6,"i7":6,"i8":6,"i9":6,"i10":6,"i11":6,"i12":6,"i13":6,"i14":6,"i15":6,"i16":6,"i17":6,"i18":6,"i19":6,"i20":6,"i21":38,"i22":6,"i23":38,"i24":38,"i25":6,"i26":6,"i27":6,"i28":38,"i29":6,"i30":38,"i31":6,"i32":6,"i33":6,"i34":6,"i35":6,"i36":6,"i37":6,"i38":6,"i39":6,"i40":6,"i41":6,"i42":6,"i43":6,"i44":6,"i45":38,"i46":38,"i47":38,"i48":38,"i49":38,"i50":38,"i51":38};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"],32:["t6","Deprecated Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../../";
var useModuleDirectories = false;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CardTransactionManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><span></span><span style="line-height: 30px"> Calypsonet Terminal Calypso API - 1.7.0-SNAPSHOT</span></div>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.calypsonet.terminal.calypso.transaction</a></div>
<h2 title="Interface CardTransactionManager" class="title">Interface CardTransactionManager</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Superinterfaces:</dt>
<dd><code><a href="CommonTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CommonTransactionManager</a>&lt;<a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>,&#8203;<a href="CardSecuritySetting.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardSecuritySetting</a>&gt;</code></dd>
</dl>
<hr>
<pre>public interface <span class="typeNameLabel">CardTransactionManager</span>
extends <a href="CommonTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CommonTransactionManager</a>&lt;<a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>,&#8203;<a href="CardSecuritySetting.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardSecuritySetting</a>&gt;</pre>
<div class="block">Service providing the high-level API to manage transactions with a Calypso card.

 <p>Depending on the type of operations required, the presence of a SAM may be necessary.

 <p>The <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> object provided to the build is kept and updated at each step of using
 the service. It is the main container of the data handled during the transaction and acts as a
 card image.

 <p>There are two main steps in using the methods of this service:

 <ul>
   <li>A command preparation step during which the application invokes prefixed "prepare" methods
       that will add to an internal list of commands to be executed by the card. The incoming data
       to the card are placed in <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>.
   <li>A processing step corresponding to the prefixed "process" methods, which will carry out the
       communications with the card and if necessary the SAM. The outgoing data from the card are
       placed in <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>.
 </ul>

 <p>Technical or data errors, security conditions, etc. are reported as exceptions.

 <p>For all "prepare" type commands, unless otherwise specified, here are the ranges of values
 checked for the various parameters:

 <ul>
   <li>SFI: [0..30] (0 indicates the current EF)
   <li>Record number: [1..250]
   <li>Counter number: [1..83]
   <li>Counter value: [0..16777215]
   <li>Offset: [0..249] or [0..32767] for binary files (0 indicates the first byte)
   <li>Input data length: [1..250] or [1..32767] for binary files
 </ul></div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t6" class="tableTab"><span><a href="javascript:show(32);">Deprecated Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card">CalypsoCard</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getCalypsoCard()">getCalypsoCard</a></span>()</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Useless accessor (will be soon removed).</div>
</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>org.calypsonet.terminal.reader.CardReader</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getCardReader()">getCardReader</a></span>()</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Useless accessor (will be soon removed).</div>
</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="CardSecuritySetting.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardSecuritySetting</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getCardSecuritySetting()">getCardSecuritySetting</a></span>()</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="CommonTransactionManager.html#getSecuritySetting()"><code>CommonTransactionManager.getSecuritySetting()</code></a> instead.</div>
</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareActivateEncryption()">prepareActivateEncryption</a></span>()</code></th>
<td class="colLast">
<div class="block">Requests the encryption of all following commands.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareAppendRecord(byte,byte%5B%5D)">prepareAppendRecord</a></span>&#8203;(byte&nbsp;sfi,
                   byte[]&nbsp;recordData)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>Append Record</b> command to adds the data provided in the
 indicated cyclic file.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareCancelSecureSession()">prepareCancelSecureSession</a></span>()</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a secure session canceling command.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareChangeKey(int,byte,byte,byte,byte)">prepareChangeKey</a></span>&#8203;(int&nbsp;keyIndex,
                byte&nbsp;newKif,
                byte&nbsp;newKvc,
                byte&nbsp;issuerKif,
                byte&nbsp;issuerKvc)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a key loading command to replace one of the current card keys with
 another key present in the SAM.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareChangePin(byte%5B%5D)">prepareChangePin</a></span>&#8203;(byte[]&nbsp;newPin)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a PIN modification command to replace the current PIN with the new
 value provided.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareCheckPinStatus()">prepareCheckPinStatus</a></span>()</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>Verify Pin</b> command without PIN presentation in order to get
 the attempt counter.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareCloseSecureSession()">prepareCloseSecureSession</a></span>()</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a secure session closing command.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareDeactivateEncryption()">prepareDeactivateEncryption</a></span>()</code></th>
<td class="colLast">
<div class="block">Requests to stop encryption for the following commands.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareDecreaseCounter(byte,int,int)">prepareDecreaseCounter</a></span>&#8203;(byte&nbsp;sfi,
                      int&nbsp;counterNumber,
                      int&nbsp;decValue)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>Decrease</b> command to decrease the target counter.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareDecreaseCounters(byte,java.util.Map)">prepareDecreaseCounters</a></span>&#8203;(byte&nbsp;sfi,
                       java.util.Map&lt;java.lang.Integer,&#8203;java.lang.Integer&gt;&nbsp;counterNumberToDecValueMap)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>Decrease Multiple</b> command or multiple <b>Decrease</b>
 commands to decrease multiple target counters at the same time.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareEarlyMutualAuthentication()">prepareEarlyMutualAuthentication</a></span>()</code></th>
<td class="colLast">
<div class="block">Requests to mutually authenticate the card and the terminal before the secure session is
 closed.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareGetData(org.calypsonet.terminal.calypso.GetDataTag)">prepareGetData</a></span>&#8203;(<a href="../GetDataTag.html" title="enum in org.calypsonet.terminal.calypso">GetDataTag</a>&nbsp;tag)</code></th>
<td class="colLast">
<div class="block">Adds a command APDU to retrieve the data indicated by the provided tag.</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareIncreaseCounter(byte,int,int)">prepareIncreaseCounter</a></span>&#8203;(byte&nbsp;sfi,
                      int&nbsp;counterNumber,
                      int&nbsp;incValue)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>Increase</b> command to increase the target counter.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareIncreaseCounters(byte,java.util.Map)">prepareIncreaseCounters</a></span>&#8203;(byte&nbsp;sfi,
                       java.util.Map&lt;java.lang.Integer,&#8203;java.lang.Integer&gt;&nbsp;counterNumberToIncValueMap)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>Increase Multiple</b> command or multiple <b>Increase</b>
 commands to increase multiple target counters at the same time.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareInvalidate()">prepareInvalidate</a></span>()</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>Invalidate</b> command.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareOpenSecureSession(org.calypsonet.terminal.calypso.WriteAccessLevel)">prepareOpenSecureSession</a></span>&#8203;(<a href="../WriteAccessLevel.html" title="enum in org.calypsonet.terminal.calypso">WriteAccessLevel</a>&nbsp;writeAccessLevel)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a secure session opening command.</div>
</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareReadBinary(byte,int,int)">prepareReadBinary</a></span>&#8203;(byte&nbsp;sfi,
                 int&nbsp;offset,
                 int&nbsp;nbBytesToRead)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of one or multiple <b>Read Binary</b> commands to read all or part of
 the indicated Binary EF.</div>
</td>
</tr>
<tr id="i20" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareReadCounter(byte,int)">prepareReadCounter</a></span>&#8203;(byte&nbsp;sfi,
                  int&nbsp;nbCountersToRead)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>Read Records</b> command to reads a record of the indicated EF,
 which should be a counter file.</div>
</td>
</tr>
<tr id="i21" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareReadCounterFile(byte,int)">prepareReadCounterFile</a></span>&#8203;(byte&nbsp;sfi,
                      int&nbsp;countersNumber)</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareReadCounter(byte,int)"><code>prepareReadCounter(byte, int)</code></a> method instead.</div>
</div>
</td>
</tr>
<tr id="i22" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareReadRecord(byte,int)">prepareReadRecord</a></span>&#8203;(byte&nbsp;sfi,
                 int&nbsp;recordNumber)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>Read Records</b> command to read a single record from the
 indicated EF.</div>
</td>
</tr>
<tr id="i23" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareReadRecordFile(byte,int)">prepareReadRecordFile</a></span>&#8203;(byte&nbsp;sfi,
                     int&nbsp;recordNumber)</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareReadRecord(byte,int)"><code>prepareReadRecord(byte, int)</code></a> method instead.</div>
</div>
</td>
</tr>
<tr id="i24" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareReadRecordFile(byte,int,int,int)">prepareReadRecordFile</a></span>&#8203;(byte&nbsp;sfi,
                     int&nbsp;firstRecordNumber,
                     int&nbsp;numberOfRecords,
                     int&nbsp;recordSize)</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareReadRecords(byte,int,int,int)"><code>prepareReadRecords(byte, int, int, int)</code></a> method instead.</div>
</div>
</td>
</tr>
<tr id="i25" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareReadRecords(byte,int,int,int)">prepareReadRecords</a></span>&#8203;(byte&nbsp;sfi,
                  int&nbsp;fromRecordNumber,
                  int&nbsp;toRecordNumber,
                  int&nbsp;recordSize)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>Read Records</b> command to read one or more records from the
 indicated EF.</div>
</td>
</tr>
<tr id="i26" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareReadRecordsPartially(byte,int,int,int,int)">prepareReadRecordsPartially</a></span>&#8203;(byte&nbsp;sfi,
                           int&nbsp;fromRecordNumber,
                           int&nbsp;toRecordNumber,
                           int&nbsp;offset,
                           int&nbsp;nbBytesToRead)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of one or multiple <b>Read Record Multiple</b> commands to read all or
 parts of multiple records of the indicated EF.</div>
</td>
</tr>
<tr id="i27" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareRehabilitate()">prepareRehabilitate</a></span>()</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>Rehabilitate</b> command.</div>
</td>
</tr>
<tr id="i28" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareReleaseCardChannel()">prepareReleaseCardChannel</a></span>()</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="CommonTransactionManager.html#processCommands(boolean)"><code>CommonTransactionManager.processCommands(boolean)</code></a> method instead.</div>
</div>
</td>
</tr>
<tr id="i29" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareSearchRecords(org.calypsonet.terminal.calypso.transaction.SearchCommandData)">prepareSearchRecords</a></span>&#8203;(<a href="SearchCommandData.html" title="interface in org.calypsonet.terminal.calypso.transaction">SearchCommandData</a>&nbsp;data)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>Search Record Multiple</b> command to search data in the
 records of the indicated EF, from a given record to the last record of the file.</div>
</td>
</tr>
<tr id="i30" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareSelectFile(byte%5B%5D)">prepareSelectFile</a></span>&#8203;(byte[]&nbsp;lid)</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareSelectFile(short)"><code>prepareSelectFile(short)</code></a> method instead.</div>
</div>
</td>
</tr>
<tr id="i31" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareSelectFile(short)">prepareSelectFile</a></span>&#8203;(short&nbsp;lid)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>Select File</b> command to select an EF by its LID in the
 current DF</div>
</td>
</tr>
<tr id="i32" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareSelectFile(org.calypsonet.terminal.calypso.SelectFileControl)">prepareSelectFile</a></span>&#8203;(<a href="../SelectFileControl.html" title="enum in org.calypsonet.terminal.calypso">SelectFileControl</a>&nbsp;selectFileControl)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>Select File</b> command using a navigation selectFileControl
 defined by the ISO standard.</div>
</td>
</tr>
<tr id="i33" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareSetCounter(byte,int,int)">prepareSetCounter</a></span>&#8203;(byte&nbsp;sfi,
                 int&nbsp;counterNumber,
                 int&nbsp;newValue)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a command to set the value of the target counter.</div>
</td>
</tr>
<tr id="i34" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareSvDebit(int)">prepareSvDebit</a></span>&#8203;(int&nbsp;amount)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>SV Debit</b> or <b>SV Undebit</b> command to increase the
 current SV balance or to partially or totally cancels the last SV debit command.</div>
</td>
</tr>
<tr id="i35" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareSvDebit(int,byte%5B%5D,byte%5B%5D)">prepareSvDebit</a></span>&#8203;(int&nbsp;amount,
              byte[]&nbsp;date,
              byte[]&nbsp;time)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>SV Debit</b> or <b>SV Undebit</b> command to increase the
 current SV balance or to partially or totally cancels the last SV debit command and using the
 provided additional data.</div>
</td>
</tr>
<tr id="i36" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareSvGet(org.calypsonet.terminal.calypso.transaction.SvOperation,org.calypsonet.terminal.calypso.transaction.SvAction)">prepareSvGet</a></span>&#8203;(<a href="SvOperation.html" title="enum in org.calypsonet.terminal.calypso.transaction">SvOperation</a>&nbsp;svOperation,
            <a href="SvAction.html" title="enum in org.calypsonet.terminal.calypso.transaction">SvAction</a>&nbsp;svAction)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>SV Get</b> command to prepare an SV operation or simply
 retrieves the current SV status.</div>
</td>
</tr>
<tr id="i37" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareSvReadAllLogs()">prepareSvReadAllLogs</a></span>()</code></th>
<td class="colLast">
<div class="block">Schedules the execution of <b>Read Records</b> commands to read all SV logs.</div>
</td>
</tr>
<tr id="i38" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareSvReload(int)">prepareSvReload</a></span>&#8203;(int&nbsp;amount)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>SV Reload</b> command to increase the current SV balance.</div>
</td>
</tr>
<tr id="i39" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareSvReload(int,byte%5B%5D,byte%5B%5D,byte%5B%5D)">prepareSvReload</a></span>&#8203;(int&nbsp;amount,
               byte[]&nbsp;date,
               byte[]&nbsp;time,
               byte[]&nbsp;free)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>SV Reload</b> command to increase the current SV balance and
 using the provided additional data.</div>
</td>
</tr>
<tr id="i40" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareUpdateBinary(byte,int,byte%5B%5D)">prepareUpdateBinary</a></span>&#8203;(byte&nbsp;sfi,
                   int&nbsp;offset,
                   byte[]&nbsp;data)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>Update Binary</b> command to replace the indicated data of a
 Binary file with the new data given from the indicated offset.</div>
</td>
</tr>
<tr id="i41" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareUpdateRecord(byte,int,byte%5B%5D)">prepareUpdateRecord</a></span>&#8203;(byte&nbsp;sfi,
                   int&nbsp;recordNumber,
                   byte[]&nbsp;recordData)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>Update Record</b> command to overwrites the target file's
 record contents with the provided data.</div>
</td>
</tr>
<tr id="i42" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareVerifyPin(byte%5B%5D)">prepareVerifyPin</a></span>&#8203;(byte[]&nbsp;pin)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a PIN verification command in order to authenticate the cardholder
 and/or unlock access to certain card files.</div>
</td>
</tr>
<tr id="i43" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareWriteBinary(byte,int,byte%5B%5D)">prepareWriteBinary</a></span>&#8203;(byte&nbsp;sfi,
                  int&nbsp;offset,
                  byte[]&nbsp;data)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>Write Binary</b> command to write over the indicated data of a
 Binary file.</div>
</td>
</tr>
<tr id="i44" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareWriteRecord(byte,int,byte%5B%5D)">prepareWriteRecord</a></span>&#8203;(byte&nbsp;sfi,
                  int&nbsp;recordNumber,
                  byte[]&nbsp;recordData)</code></th>
<td class="colLast">
<div class="block">Schedules the execution of a <b>Write Record</b> command to updates the target file's record
 contents with the result of a binary OR between the existing data and the provided data.</div>
</td>
</tr>
<tr id="i45" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#processCancel()">processCancel</a></span>()</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareCancelSecureSession()"><code>prepareCancelSecureSession()</code></a> method instead.</div>
</div>
</td>
</tr>
<tr id="i46" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#processCardCommands()">processCardCommands</a></span>()</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="CommonTransactionManager.html#processCommands()"><code>CommonTransactionManager.processCommands()</code></a> instead.</div>
</div>
</td>
</tr>
<tr id="i47" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#processChangeKey(int,byte,byte,byte,byte)">processChangeKey</a></span>&#8203;(int&nbsp;keyIndex,
                byte&nbsp;newKif,
                byte&nbsp;newKvc,
                byte&nbsp;issuerKif,
                byte&nbsp;issuerKvc)</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareChangeKey(int,byte,byte,byte,byte)"><code>prepareChangeKey(int, byte, byte, byte, byte)</code></a> method instead.</div>
</div>
</td>
</tr>
<tr id="i48" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#processChangePin(byte%5B%5D)">processChangePin</a></span>&#8203;(byte[]&nbsp;newPin)</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareChangePin(byte%5B%5D)"><code>prepareChangePin(byte[])</code></a> method instead.</div>
</div>
</td>
</tr>
<tr id="i49" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#processClosing()">processClosing</a></span>()</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareCloseSecureSession()"><code>prepareCloseSecureSession()</code></a> method instead.</div>
</div>
</td>
</tr>
<tr id="i50" class="altColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#processOpening(org.calypsonet.terminal.calypso.WriteAccessLevel)">processOpening</a></span>&#8203;(<a href="../WriteAccessLevel.html" title="enum in org.calypsonet.terminal.calypso">WriteAccessLevel</a>&nbsp;writeAccessLevel)</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareOpenSecureSession(org.calypsonet.terminal.calypso.WriteAccessLevel)"><code>prepareOpenSecureSession(WriteAccessLevel)</code></a> method instead.</div>
</div>
</td>
</tr>
<tr id="i51" class="rowColor">
<td class="colFirst"><code><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#processVerifyPin(byte%5B%5D)">processVerifyPin</a></span>&#8203;(byte[]&nbsp;pin)</code></th>
<td class="colLast">
<div class="block"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareVerifyPin(byte%5B%5D)"><code>prepareVerifyPin(byte[])</code></a> method instead.</div>
</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.org.calypsonet.terminal.calypso.transaction.CommonTransactionManager">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;org.calypsonet.terminal.calypso.transaction.<a href="CommonTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CommonTransactionManager</a></h3>
<code><a href="CommonTransactionManager.html#getSecuritySetting()">getSecuritySetting</a>, <a href="CommonTransactionManager.html#getTransactionAuditData()">getTransactionAuditData</a>, <a href="CommonTransactionManager.html#prepareComputeSignature(org.calypsonet.terminal.calypso.transaction.CommonSignatureComputationData)">prepareComputeSignature</a>, <a href="CommonTransactionManager.html#prepareVerifySignature(org.calypsonet.terminal.calypso.transaction.CommonSignatureVerificationData)">prepareVerifySignature</a>, <a href="CommonTransactionManager.html#processCommands()">processCommands</a>, <a href="CommonTransactionManager.html#processCommands(boolean)">processCommands</a></code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="getCardReader()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCardReader</h4>
<pre class="methodSignature">@Deprecated
org.calypsonet.terminal.reader.CardReader&nbsp;getCardReader()</pre>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Useless accessor (will be soon removed).</div>
</div>
<div class="block">Gets the reader used to communicate with the target card on which the transaction is performed.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A not null reference.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="getCalypsoCard()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCalypsoCard</h4>
<pre class="methodSignature">@Deprecated
<a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card">CalypsoCard</a>&nbsp;getCalypsoCard()</pre>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Useless accessor (will be soon removed).</div>
</div>
<div class="block">Gets the target card on which the transaction is performed.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A not null <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> having a <a href="../card/CalypsoCard.ProductType.html" title="enum in org.calypsonet.terminal.calypso.card"><code>CalypsoCard.ProductType</code></a> different from
     <a href="../card/CalypsoCard.ProductType.html#UNKNOWN"><code>CalypsoCard.ProductType.UNKNOWN</code></a>.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="getCardSecuritySetting()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCardSecuritySetting</h4>
<pre class="methodSignature">@Deprecated
<a href="CardSecuritySetting.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardSecuritySetting</a>&nbsp;getCardSecuritySetting()</pre>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="CommonTransactionManager.html#getSecuritySetting()"><code>CommonTransactionManager.getSecuritySetting()</code></a> instead. (will be soon removed)</div>
</div>
<div class="block">Gets the settings defining the security parameters of the transaction.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Null if the transaction does not use security settings.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareSelectFile(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareSelectFile</h4>
<pre class="methodSignature">@Deprecated
<a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareSelectFile&#8203;(byte[]&nbsp;lid)</pre>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareSelectFile(short)"><code>prepareSelectFile(short)</code></a> method instead. (will be soon removed)</div>
</div>
<div class="block">Schedules the execution of a <b>Select File</b> command based on the file's LID.

 <p>Once this command is processed, the result is available in <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> through the
 <a href="../card/CalypsoCard.html#getFileBySfi(byte)"><code>CalypsoCard.getFileBySfi(byte)</code></a>/<a href="../card/CalypsoCard.html#getFileByLid(short)"><code>CalypsoCard.getFileByLid(short)</code></a> and <a href="../card/ElementaryFile.html#getHeader()"><code>ElementaryFile.getHeader()</code></a> methods.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>lid</code> - The LID of the EF to select.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If the provided lid is not 2 bytes long.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareSelectFile(short)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareSelectFile</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareSelectFile&#8203;(short&nbsp;lid)</pre>
<div class="block">Schedules the execution of a <b>Select File</b> command to select an EF by its LID in the
 current DF

 <p>Once this command is processed, the result is available in <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> through the
 <a href="../card/CalypsoCard.html#getFileBySfi(byte)"><code>CalypsoCard.getFileBySfi(byte)</code></a>/<a href="../card/CalypsoCard.html#getFileByLid(short)"><code>CalypsoCard.getFileByLid(short)</code></a> and <a href="../card/ElementaryFile.html#getHeader()"><code>ElementaryFile.getHeader()</code></a> methods.

 <p>Caution: the command will fail if the selected file is not an EF.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>lid</code> - The LID of the EF to select.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.0</dd>
</dl>
</li>
</ul>
<a id="prepareSelectFile(org.calypsonet.terminal.calypso.SelectFileControl)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareSelectFile</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareSelectFile&#8203;(<a href="../SelectFileControl.html" title="enum in org.calypsonet.terminal.calypso">SelectFileControl</a>&nbsp;selectFileControl)</pre>
<div class="block">Schedules the execution of a <b>Select File</b> command using a navigation selectFileControl
 defined by the ISO standard.

 <p>Once this command is processed, the result is available in <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> through the
 <a href="../card/ElementaryFile.html#getHeader()"><code>ElementaryFile.getHeader()</code></a> methods.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>selectFileControl</code> - A <a href="../SelectFileControl.html" title="enum in org.calypsonet.terminal.calypso"><code>SelectFileControl</code></a> enum entry.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If selectFileControl is null.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareGetData(org.calypsonet.terminal.calypso.GetDataTag)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareGetData</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareGetData&#8203;(<a href="../GetDataTag.html" title="enum in org.calypsonet.terminal.calypso">GetDataTag</a>&nbsp;tag)</pre>
<div class="block">Adds a command APDU to retrieve the data indicated by the provided tag.

 <p>The data returned by the command is used to update the current <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> object.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tag</code> - The tag to use.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The object instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.UnsupportedOperationException</code> - If the Get Data command with the provided tag is not
     supported.</dd>
<dd><code>java.lang.IllegalArgumentException</code> - If tag is null.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareReadRecordFile(byte,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareReadRecordFile</h4>
<pre class="methodSignature">@Deprecated
<a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareReadRecordFile&#8203;(byte&nbsp;sfi,
                                             int&nbsp;recordNumber)</pre>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareReadRecord(byte,int)"><code>prepareReadRecord(byte, int)</code></a> method instead. (will be soon removed)</div>
</div>
<div class="block">Schedules the execution of a <b>Read Records</b> command to read a single record from the
 indicated EF.

 <p>Once this command is processed, the result is available in <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>.

 <p>Depending on whether we are inside a secure session, there are two types of behavior
 following this command:

 <ul>
   <li>Outside a secure session (best effort mode): the following "process" command will not
       fail whatever the existence of the targeted file or record (the <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>
       object may not be filled).
   <li>Inside a secure session in contactless mode (strict mode): the following "process"
       command will fail if the targeted file or record does not exist (the <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>
       object is always filled or an exception is raised when the reading failed).
 </ul>

 <p><b>This method should not be used inside a secure session in contact mode</b> because
 additional exchanges with the card will be operated and will corrupt the security of the
 session. Instead, use the method <a href="#prepareReadRecordFile(byte,int,int,int)"><code>prepareReadRecordFile(byte, int, int, int)</code></a> for this
 case and provide valid parameters.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sfi</code> - The SFI of the EF to read.</dd>
<dd><code>recordNumber</code> - The record to read.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided arguments is out of range.</dd>
<dd><code>java.lang.IllegalStateException</code> - If this method is invoked inside a secure session in contact
     mode.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareReadRecordFile(byte,int,int,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareReadRecordFile</h4>
<pre class="methodSignature">@Deprecated
<a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareReadRecordFile&#8203;(byte&nbsp;sfi,
                                             int&nbsp;firstRecordNumber,
                                             int&nbsp;numberOfRecords,
                                             int&nbsp;recordSize)</pre>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareReadRecords(byte,int,int,int)"><code>prepareReadRecords(byte, int, int, int)</code></a> method instead. (will be soon
     removed)</div>
</div>
<div class="block">Schedules the execution of a <b>Read Records</b> command to read one or more records from the
 indicated EF.

 <p>Once this command is processed, the result is available in <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>.

 <p>Depending on whether we are inside a secure session, there are two types of behavior
 following this command:

 <ul>
   <li>Outside a secure session (best effort mode): the following "process" command will not
       fail whatever the existence of the targeted file or record (the <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>
       object may not be filled).
   <li>Inside a secure session (strict mode): the following "process" command will fail if the
       targeted file or record does not exist (the <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> object is always filled
       or an exception is raised when the reading failed).<br>
       Invalid parameters could lead to additional exchanges with the card and thus corrupt the
       security of the session.
 </ul></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sfi</code> - The SFI of the EF.</dd>
<dd><code>firstRecordNumber</code> - The record to read (or first record to read in case of several
     records)</dd>
<dd><code>numberOfRecords</code> - The number of records expected.</dd>
<dd><code>recordSize</code> - The record length.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided argument is out of range.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareReadCounterFile(byte,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareReadCounterFile</h4>
<pre class="methodSignature">@Deprecated
<a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareReadCounterFile&#8203;(byte&nbsp;sfi,
                                              int&nbsp;countersNumber)</pre>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareReadCounter(byte,int)"><code>prepareReadCounter(byte, int)</code></a> method instead. (will be soon removed)</div>
</div>
<div class="block">Schedules the execution of a <b>Read Records</b> command to reads a record of the indicated EF,
 which should be a counter file.

 <p>The record will be read up to the counter location indicated in parameter.<br>
 Thus, all previous counters will also be read.

 <p>Once this command is processed, the result is available in <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>.

 <p>Depending on whether we are inside a secure session, there are two types of behavior
 following this command:

 <ul>
   <li>Outside a secure session (best effort mode): the following "process" command will not
       fail whatever the existence of the targeted file or counter (the <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>
       object may not be filled).
   <li>Inside a secure session (strict mode): the following "process" command will fail if the
       targeted file or counter does not exist (the <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> object is always filled
       or an exception is raised when the reading failed).<br>
       Invalid parameters could lead to additional exchanges with the card and thus corrupt the
       security of the session.
 </ul></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sfi</code> - The SFI of the EF.</dd>
<dd><code>countersNumber</code> - The number of the last counter to be read.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided argument is out of range.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareReadRecord(byte,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareReadRecord</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareReadRecord&#8203;(byte&nbsp;sfi,
                                         int&nbsp;recordNumber)</pre>
<div class="block">Schedules the execution of a <b>Read Records</b> command to read a single record from the
 indicated EF.

 <p>Once this command is processed, the result is available in <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>.

 <p>Depending on whether we are inside a secure session, there are two types of behavior
 following this command:

 <ul>
   <li>Outside a secure session (best effort mode): the following "process" command will not
       fail whatever the existence of the targeted file or record (the <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>
       object may not be filled).
   <li>Inside a secure session in contactless mode (strict mode): the following "process"
       command will fail if the targeted file or record does not exist (the <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>
       object is always filled or an exception is raised when the reading failed).
 </ul>

 <p><b>This method should not be used inside a secure session in contact mode</b> because
 additional exchanges with the card will be operated and will corrupt the security of the
 session. Instead, use the method <a href="#prepareReadRecordFile(byte,int,int,int)"><code>prepareReadRecordFile(byte, int, int, int)</code></a> for this
 case and provide valid parameters.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sfi</code> - The SFI of the EF to read.</dd>
<dd><code>recordNumber</code> - The record to read.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided arguments is out of range.</dd>
<dd><code>java.lang.IllegalStateException</code> - If this method is invoked inside a secure session in contact
     mode.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.0</dd>
</dl>
</li>
</ul>
<a id="prepareReadRecords(byte,int,int,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareReadRecords</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareReadRecords&#8203;(byte&nbsp;sfi,
                                          int&nbsp;fromRecordNumber,
                                          int&nbsp;toRecordNumber,
                                          int&nbsp;recordSize)</pre>
<div class="block">Schedules the execution of a <b>Read Records</b> command to read one or more records from the
 indicated EF.

 <p>Once this command is processed, the result is available in <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>.

 <p>Depending on whether we are inside a secure session, there are two types of behavior
 following this command:

 <ul>
   <li>Outside a secure session (best effort mode): the following "process" command will not
       fail whatever the existence of the targeted file or record (the <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>
       object may not be filled).
   <li>Inside a secure session (strict mode): the following "process" command will fail if the
       targeted file or record does not exist (the <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> object is always filled
       or an exception is raised when the reading failed).<br>
       Invalid parameters could lead to additional exchanges with the card and thus corrupt the
       security of the session.
 </ul></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sfi</code> - The SFI of the EF.</dd>
<dd><code>fromRecordNumber</code> - The number of the first record to read.</dd>
<dd><code>toRecordNumber</code> - The number of the last record to read.</dd>
<dd><code>recordSize</code> - The record length.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided argument is out of range.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.0</dd>
</dl>
</li>
</ul>
<a id="prepareReadRecordsPartially(byte,int,int,int,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareReadRecordsPartially</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareReadRecordsPartially&#8203;(byte&nbsp;sfi,
                                                   int&nbsp;fromRecordNumber,
                                                   int&nbsp;toRecordNumber,
                                                   int&nbsp;offset,
                                                   int&nbsp;nbBytesToRead)</pre>
<div class="block">Schedules the execution of one or multiple <b>Read Record Multiple</b> commands to read all or
 parts of multiple records of the indicated EF.

 <p>Once this command is processed, the result is available in <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>.

 <p>Depending on whether we are inside a secure session, there are two types of behavior
 following this command:

 <ul>
   <li>Outside a secure session (best effort mode): the following "process" command will not
       fail whatever the existence of the targeted file or the validity of the offset and number
       of bytes to read (the <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> object may not be filled).
   <li>Inside a secure session (strict mode): the following "process" command will fail if the
       targeted file does not exist or if the offset and number of bytes to read are not valid
       (the <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> object is always filled or an exception is raised when the
       reading failed).<br>
       Invalid parameters could lead to additional exchanges with the card and thus corrupt the
       security of the session.
 </ul></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sfi</code> - The SFI of the EF.</dd>
<dd><code>fromRecordNumber</code> - The number of the first record to read.</dd>
<dd><code>toRecordNumber</code> - The number of the last record to read.</dd>
<dd><code>offset</code> - The offset in the records where to start reading (0 indicates the first byte).</dd>
<dd><code>nbBytesToRead</code> - The number of bytes to read from each record.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.UnsupportedOperationException</code> - If this command is not supported by this card.</dd>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided argument is out of range.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.0</dd>
</dl>
</li>
</ul>
<a id="prepareReadBinary(byte,int,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareReadBinary</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareReadBinary&#8203;(byte&nbsp;sfi,
                                         int&nbsp;offset,
                                         int&nbsp;nbBytesToRead)</pre>
<div class="block">Schedules the execution of one or multiple <b>Read Binary</b> commands to read all or part of
 the indicated Binary EF.

 <p>Once this command is processed, the result is available in <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>.

 <p>Depending on whether we are inside a secure session, there are two types of behavior
 following this command:

 <ul>
   <li>Outside a secure session (best effort mode): the following "process" command will not
       fail whatever the existence of the targeted file or the validity of the offset and number
       of bytes to read (the <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> object may not be filled).
   <li>Inside a secure session (strict mode): the following "process" command will fail if the
       targeted file does not exist or if the offset and number of bytes to read are not valid
       (the <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> object is always filled or an exception is raised when the
       reading failed).<br>
       Invalid parameters could lead to additional exchanges with the card and thus corrupt the
       security of the session.
 </ul></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sfi</code> - The SFI of the EF.</dd>
<dd><code>offset</code> - The offset (0 indicates the first byte).</dd>
<dd><code>nbBytesToRead</code> - The number of bytes to read.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.UnsupportedOperationException</code> - If this command is not supported by this card.</dd>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided argument is out of range.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.0</dd>
</dl>
</li>
</ul>
<a id="prepareReadCounter(byte,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareReadCounter</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareReadCounter&#8203;(byte&nbsp;sfi,
                                          int&nbsp;nbCountersToRead)</pre>
<div class="block">Schedules the execution of a <b>Read Records</b> command to reads a record of the indicated EF,
 which should be a counter file.

 <p>The record will be read up to the counter location indicated in parameter.<br>
 Thus, all previous counters will also be read.

 <p>Once this command is processed, the result is available in <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>.

 <p>Depending on whether we are inside a secure session, there are two types of behavior
 following this command:

 <ul>
   <li>Outside a secure session (best effort mode): the following "process" command will not
       fail whatever the existence of the targeted file or counter (the <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>
       object may not be filled).
   <li>Inside a secure session (strict mode): the following "process" command will fail if the
       targeted file or counter does not exist (the <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> object is always filled
       or an exception is raised when the reading failed).<br>
       Invalid parameters could lead to additional exchanges with the card and thus corrupt the
       security of the session.
 </ul></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sfi</code> - The SFI of the EF.</dd>
<dd><code>nbCountersToRead</code> - The number of counters to read.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided argument is out of range.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.0</dd>
</dl>
</li>
</ul>
<a id="prepareSearchRecords(org.calypsonet.terminal.calypso.transaction.SearchCommandData)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareSearchRecords</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareSearchRecords&#8203;(<a href="SearchCommandData.html" title="interface in org.calypsonet.terminal.calypso.transaction">SearchCommandData</a>&nbsp;data)</pre>
<div class="block">Schedules the execution of a <b>Search Record Multiple</b> command to search data in the
 records of the indicated EF, from a given record to the last record of the file. It will return
 the list of record numbers containing these data, and if requested it will read the first
 record content.

 <p>The command is only possible with a Linear, Cyclic, Counters or Simulated Counter EF.

 <p>The command searches if the given data are present in the records of the file. During the
 search, an optional mask is applied. The mask allows to specify precisely the bits to be taken
 into account in the comparison.

 <p>See <a href="SearchCommandData.html" title="interface in org.calypsonet.terminal.calypso.transaction"><code>SearchCommandData</code></a> class for a description of the parameters.

 <p>Once this command is processed, the result is available in the provided input/output <a href="SearchCommandData.html" title="interface in org.calypsonet.terminal.calypso.transaction"><code>SearchCommandData</code></a> object, and the content of the first matching record in <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>
 if requested.

 <p>Depending on whether we are inside a secure session, there are two types of behavior
 following this command:

 <ul>
   <li>Outside a secure session (best effort mode): the following "process" command will not
       fail whatever the existence of the targeted file or the validity of the record number and
       offset (the <a href="SearchCommandData.html" title="interface in org.calypsonet.terminal.calypso.transaction"><code>SearchCommandData</code></a> and <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> objects may not be
       updated).
   <li>Inside a secure session (strict mode): the following "process" command will fail if the
       targeted file does not exist or if the record number and the offset are not valid (the
       <a href="SearchCommandData.html" title="interface in org.calypsonet.terminal.calypso.transaction"><code>SearchCommandData</code></a> and <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> objects are always filled or an
       exception is raised when the reading failed).
 </ul></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>data</code> - The input/output data containing the parameters of the command.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.UnsupportedOperationException</code> - If the "Search Record Multiple" command is not available
     for this card.</dd>
<dd><code>java.lang.IllegalArgumentException</code> - If the input data is inconsistent.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.0</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="SearchCommandData.html" title="interface in org.calypsonet.terminal.calypso.transaction"><code>SearchCommandData</code></a></dd>
</dl>
</li>
</ul>
<a id="prepareCheckPinStatus()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareCheckPinStatus</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareCheckPinStatus()</pre>
<div class="block">Schedules the execution of a <b>Verify Pin</b> command without PIN presentation in order to get
 the attempt counter.

 <p>The PIN status will be made available in CalypsoCard after the execution of process command.
 <br>
 Adds it to the list of commands to be sent with the next process command.

 <p>See <a href="../card/CalypsoCard.html#isPinBlocked()"><code>CalypsoCard.isPinBlocked()</code></a> and <a href="../card/CalypsoCard.html#getPinAttemptRemaining()"><code>CalypsoCard.getPinAttemptRemaining()</code></a> methods.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.UnsupportedOperationException</code> - If the PIN feature is not available for this card.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareAppendRecord(byte,byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareAppendRecord</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareAppendRecord&#8203;(byte&nbsp;sfi,
                                           byte[]&nbsp;recordData)</pre>
<div class="block">Schedules the execution of a <b>Append Record</b> command to adds the data provided in the
 indicated cyclic file.

 <p>A new record is added, the oldest record is deleted.

 <p>Note: <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> is filled with the provided input data.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sfi</code> - The sfi to select.</dd>
<dd><code>recordData</code> - The new record data to write.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided argument is out of range.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareUpdateRecord(byte,int,byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareUpdateRecord</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareUpdateRecord&#8203;(byte&nbsp;sfi,
                                           int&nbsp;recordNumber,
                                           byte[]&nbsp;recordData)</pre>
<div class="block">Schedules the execution of a <b>Update Record</b> command to overwrites the target file's
 record contents with the provided data.

 <p>If the input data is shorter than the record size, only the first bytes will be overwritten.

 <p>Note: <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> is filled with the provided input data.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sfi</code> - The sfi to select.</dd>
<dd><code>recordNumber</code> - The record to update.</dd>
<dd><code>recordData</code> - The new record data. If length <code>&lt;</code> RecSize, bytes beyond length are.
     left unchanged.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided argument is out of range.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareWriteRecord(byte,int,byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareWriteRecord</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareWriteRecord&#8203;(byte&nbsp;sfi,
                                          int&nbsp;recordNumber,
                                          byte[]&nbsp;recordData)</pre>
<div class="block">Schedules the execution of a <b>Write Record</b> command to updates the target file's record
 contents with the result of a binary OR between the existing data and the provided data.

 <p>If the input data is shorter than the record size, only the first bytes will be overwritten.

 <p>Note: <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> is filled with the provided input data.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sfi</code> - The sfi to select.</dd>
<dd><code>recordNumber</code> - The record to write.</dd>
<dd><code>recordData</code> - The data to overwrite in the record. If length <code>&lt;</code> RecSize, bytes.
     beyond length are left unchanged.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided argument is out of range.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareUpdateBinary(byte,int,byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareUpdateBinary</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareUpdateBinary&#8203;(byte&nbsp;sfi,
                                           int&nbsp;offset,
                                           byte[]&nbsp;data)</pre>
<div class="block">Schedules the execution of a <b>Update Binary</b> command to replace the indicated data of a
 Binary file with the new data given from the indicated offset.

 <p>The data of the file before the offset and after the data given are left unchanged.

 <p>Note: <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> is filled with the provided input data.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sfi</code> - The SFI of the EF to select.</dd>
<dd><code>offset</code> - The offset (0 indicates the first byte).</dd>
<dd><code>data</code> - The new data.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.UnsupportedOperationException</code> - If this command is not supported by this card.</dd>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided argument is out of range.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.0</dd>
</dl>
</li>
</ul>
<a id="prepareWriteBinary(byte,int,byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareWriteBinary</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareWriteBinary&#8203;(byte&nbsp;sfi,
                                          int&nbsp;offset,
                                          byte[]&nbsp;data)</pre>
<div class="block">Schedules the execution of a <b>Write Binary</b> command to write over the indicated data of a
 Binary file. The new data will be the result of a binary OR operation between the existing data
 and the data given in the command from the indicated offset.

 <p>The data of the file before the offset and after the data given are left unchanged.

 <p>Note: <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> is computed with the provided input data.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sfi</code> - The SFI of the EF to select.</dd>
<dd><code>offset</code> - The offset (0 indicates the first byte).</dd>
<dd><code>data</code> - The data to write over the existing data.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.UnsupportedOperationException</code> - If this command is not supported by this card.</dd>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided argument is out of range.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.0</dd>
</dl>
</li>
</ul>
<a id="prepareIncreaseCounter(byte,int,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareIncreaseCounter</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareIncreaseCounter&#8203;(byte&nbsp;sfi,
                                              int&nbsp;counterNumber,
                                              int&nbsp;incValue)</pre>
<div class="block">Schedules the execution of a <b>Increase</b> command to increase the target counter.

 <p>Note 1: <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> is updated with the provided input data.

 <p>Note 2: in the case where this method is invoked before the invocation of <a href="#processClosing()"><code>processClosing()</code></a>, the counter must have been read previously otherwise an <code>IllegalStateException</code> will be raised during the execution of <a href="#processClosing()"><code>processClosing()</code></a>.

 <p>Note 3: if several counters of the same file have to be incremented at the same time of the
 transaction, it is recommended to use the method <a href="#prepareIncreaseCounters(byte,java.util.Map)"><code>prepareIncreaseCounters(byte, Map)</code></a>
 for optimization reasons.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sfi</code> - SFI of the EF to select.</dd>
<dd><code>counterNumber</code> - The number of the counter (must be zero in case of a simulated counter).</dd>
<dd><code>incValue</code> - Value to add to the counter (defined as a positive int <code>&lt;=</code> 16777215
     [FFFFFFh])</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided argument is out of range.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareIncreaseCounters(byte,java.util.Map)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareIncreaseCounters</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareIncreaseCounters&#8203;(byte&nbsp;sfi,
                                               java.util.Map&lt;java.lang.Integer,&#8203;java.lang.Integer&gt;&nbsp;counterNumberToIncValueMap)</pre>
<div class="block">Schedules the execution of a <b>Increase Multiple</b> command or multiple <b>Increase</b>
 commands to increase multiple target counters at the same time.

 <p>The decision to execute one or the other command is made according to the type of card.

 <p>Note 1: <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> is updated with the provided input data.

 <p>Note 2: in the case where this method is invoked before the invocation of <a href="#processClosing()"><code>processClosing()</code></a>, the counter must have been read previously otherwise an <code>IllegalStateException</code> will be raised during the execution of <a href="#processClosing()"><code>processClosing()</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sfi</code> - SFI of the EF to select.</dd>
<dd><code>counterNumberToIncValueMap</code> - The map containing the counter numbers to be incremented and
     their associated increment values.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided argument is out of range or if the map
     is null or empty.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.0</dd>
</dl>
</li>
</ul>
<a id="prepareDecreaseCounter(byte,int,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareDecreaseCounter</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareDecreaseCounter&#8203;(byte&nbsp;sfi,
                                              int&nbsp;counterNumber,
                                              int&nbsp;decValue)</pre>
<div class="block">Schedules the execution of a <b>Decrease</b> command to decrease the target counter.

 <p>Note 1: <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> is updated with the provided input data.

 <p>Note 2: in the case where this method is invoked before the invocation of <a href="#processClosing()"><code>processClosing()</code></a>, the counter must have been read previously otherwise an <code>IllegalStateException</code> will be raised during the execution of <a href="#processClosing()"><code>processClosing()</code></a>.

 <p>Note 3: if several counters of the same file have to be decremented at the same time of the
 transaction, it is recommended to use the method <a href="#prepareDecreaseCounters(byte,java.util.Map)"><code>prepareDecreaseCounters(byte, Map)</code></a>
 for optimization reasons.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sfi</code> - SFI of the EF to select.</dd>
<dd><code>counterNumber</code> - The number of the counter (must be zero in case of a simulated counter).</dd>
<dd><code>decValue</code> - Value to subtract to the counter (defined as a positive int <code>&lt;=</code> 16777215
     [FFFFFFh])</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided argument is out of range.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareDecreaseCounters(byte,java.util.Map)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareDecreaseCounters</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareDecreaseCounters&#8203;(byte&nbsp;sfi,
                                               java.util.Map&lt;java.lang.Integer,&#8203;java.lang.Integer&gt;&nbsp;counterNumberToDecValueMap)</pre>
<div class="block">Schedules the execution of a <b>Decrease Multiple</b> command or multiple <b>Decrease</b>
 commands to decrease multiple target counters at the same time.

 <p>The decision to execute one or the other command is made according to the type of card.

 <p>Note 1: <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> is updated with the provided input data.

 <p>Note 2: in the case where this method is invoked before the invocation of <a href="#processClosing()"><code>processClosing()</code></a>, the counter must have been read previously otherwise an <code>IllegalStateException</code> will be raised during the execution of <a href="#processClosing()"><code>processClosing()</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sfi</code> - SFI of the EF to select.</dd>
<dd><code>counterNumberToDecValueMap</code> - The map containing the counter numbers to be decremented and
     their associated decrement values.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided argument is out of range or if the map
     is null or empty.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.0</dd>
</dl>
</li>
</ul>
<a id="prepareSetCounter(byte,int,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareSetCounter</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareSetCounter&#8203;(byte&nbsp;sfi,
                                         int&nbsp;counterNumber,
                                         int&nbsp;newValue)</pre>
<div class="block">Schedules the execution of a command to set the value of the target counter.

 <p>It builds an Increase or Decrease command and add it to the list of commands to be sent with
 the next <b>process</b> command in order to set the target counter to the specified value.<br>
 The operation (Increase or Decrease) is selected according to whether the difference between
 the current value and the desired value is negative (Increase) or positive (Decrease).

 <p>Note: it is assumed here that:<br>

 <ul>
   <li>the counter value has been read before,
   <li>the type of session (and associated access rights) is consistent with the requested
       operation: reload session if the counter is to be incremented, debit if it is to be
       decremented.<br>
       No control is performed on this point by this method; the closing of the session will
       determine the success of the operation..
 </ul></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>counterNumber</code> - <code>&gt;=</code> 1: Counters file, number of the counter. 0: Simulated. Counter
     file.</dd>
<dd><code>sfi</code> - SFI of the EF to select.</dd>
<dd><code>newValue</code> - The desired value for the counter (defined as a positive int <code>&lt;=</code>
     16777215 [FFFFFFh])</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided argument is out of range.</dd>
<dd><code>java.lang.IllegalStateException</code> - If the current counter value is unknown.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareSvGet(org.calypsonet.terminal.calypso.transaction.SvOperation,org.calypsonet.terminal.calypso.transaction.SvAction)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareSvGet</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareSvGet&#8203;(<a href="SvOperation.html" title="enum in org.calypsonet.terminal.calypso.transaction">SvOperation</a>&nbsp;svOperation,
                                    <a href="SvAction.html" title="enum in org.calypsonet.terminal.calypso.transaction">SvAction</a>&nbsp;svAction)</pre>
<div class="block">Schedules the execution of a <b>SV Get</b> command to prepare an SV operation or simply
 retrieves the current SV status.

 <p>Once this command is processed, the result is available in <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a>.

 <p>See the methods <a href="../card/CalypsoCard.html#getSvBalance()"><code>CalypsoCard.getSvBalance()</code></a>, <a href="../card/CalypsoCard.html#getSvLoadLogRecord()"><code>CalypsoCard.getSvLoadLogRecord()</code></a>, <a href="../card/CalypsoCard.html#getSvDebitLogLastRecord()"><code>CalypsoCard.getSvDebitLogLastRecord()</code></a>, <a href="../card/CalypsoCard.html#getSvDebitLogAllRecords()"><code>CalypsoCard.getSvDebitLogAllRecords()</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>svOperation</code> - Informs about the nature of the intended operation: debit or reload.</dd>
<dd><code>svAction</code> - The type of action: DO a debit or a positive reload, UNDO an undebit or a.
     negative reload</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.UnsupportedOperationException</code> - If the SV feature is not available for this card.</dd>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the arguments is null.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareSvReload(int,byte[],byte[],byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareSvReload</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareSvReload&#8203;(int&nbsp;amount,
                                       byte[]&nbsp;date,
                                       byte[]&nbsp;time,
                                       byte[]&nbsp;free)</pre>
<div class="block">Schedules the execution of a <b>SV Reload</b> command to increase the current SV balance and
 using the provided additional data.

 <p>Note #1: a communication with the SAM is done here.

 <p>Note #2: the key used is the reload key.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>amount</code> - The value to be reloaded, positive or negative integer in the range.
     -8388608..8388607</dd>
<dd><code>date</code> - 2-byte free value.</dd>
<dd><code>time</code> - 2-byte free value.</dd>
<dd><code>free</code> - 2-byte free value.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided argument is out of range.</dd>
<dd><code>java.lang.IllegalStateException</code> - In one of the following cases:
     <ul>
       <li>Another SV command was already prepared inside the same secure session.
       <li>The SV command is not placed in the first position in the list of prepared commands.
       <li>The SV command does not follow a "SV Get" command.
       <li>The command and the SV operation are not consistent.
     </ul></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareSvReload(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareSvReload</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareSvReload&#8203;(int&nbsp;amount)</pre>
<div class="block">Schedules the execution of a <b>SV Reload</b> command to increase the current SV balance.

 <p>Note #1: the optional SV additional data are set to zero.

 <p>Note #2: a communication with the SAM is done here.

 <p>Note #3: the key used is the reload key.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>amount</code> - The value to be reloaded, positive integer in the range 0..8388607 for a DO.
     action, in the range 0..8388608 for an UNDO action.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If the provided argument is out of range.</dd>
<dd><code>java.lang.IllegalStateException</code> - In one of the following cases:
     <ul>
       <li>Another SV command was already prepared inside the same secure session.
       <li>The SV command is not placed in the first position in the list of prepared commands.
       <li>The SV command does not follow a "SV Get" command.
       <li>The command and the SV operation are not consistent.
     </ul></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareSvDebit(int,byte[],byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareSvDebit</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareSvDebit&#8203;(int&nbsp;amount,
                                      byte[]&nbsp;date,
                                      byte[]&nbsp;time)</pre>
<div class="block">Schedules the execution of a <b>SV Debit</b> or <b>SV Undebit</b> command to increase the
 current SV balance or to partially or totally cancels the last SV debit command and using the
 provided additional data.

 <p>It consists in decreasing the current balance of the SV by a certain amount or canceling a
 previous debit according to the type operation chosen in when invoking the previous SV Get
 command.

 <p>Note #1: a communication with the SAM is done here.

 <p>Note #2: the key used is the reload key.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>amount</code> - The amount to be subtracted or added, positive integer in the range 0..32767 when
     subtracted and 0..32768 when added.</dd>
<dd><code>date</code> - 2-byte free value.</dd>
<dd><code>time</code> - 2-byte free value.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided argument is out of range.</dd>
<dd><code>java.lang.IllegalStateException</code> - In one of the following cases:
     <ul>
       <li>New value is negative and negative balances are not allowed.
       <li>Another SV command was already prepared inside the same secure session.
       <li>The SV command is not placed in the first position in the list of prepared commands.
       <li>The SV command does not follow a "SV Get" command.
       <li>The command and the SV operation are not consistent.
     </ul></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareSvDebit(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareSvDebit</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareSvDebit&#8203;(int&nbsp;amount)</pre>
<div class="block">Schedules the execution of a <b>SV Debit</b> or <b>SV Undebit</b> command to increase the
 current SV balance or to partially or totally cancels the last SV debit command.

 <p>It consists in decreasing the current balance of the SV by a certain amount or canceling a
 previous debit.

 <p>Note #1: the optional SV additional data are set to zero.

 <p>Note #2: a communication with the SAM is done here.

 <p>Note #3: the key used is the reload key.The information fields such as date and time are set
 to 0. The extraInfo field propagated in Logs are automatically generated with the type of
 transaction and amount.

 <p>Note #4: operations that would result in a negative balance are forbidden (SV Exception
 raised).

 <p>Note #5: the key used is the debit key</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>amount</code> - The amount to be subtracted or added, positive integer in the range 0..32767 when
     subtracted and 0..32768 when added.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If one of the provided argument is out of range.</dd>
<dd><code>java.lang.IllegalStateException</code> - In one of the following cases:
     <ul>
       <li>New value is negative and negative balances are not allowed.
       <li>Another SV command was already prepared inside the same secure session.
       <li>The SV command is not placed in the first position in the list of prepared commands.
       <li>The SV command does not follow a "SV Get" command.
       <li>The command and the SV operation are not consistent.
     </ul></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareSvReadAllLogs()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareSvReadAllLogs</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareSvReadAllLogs()</pre>
<div class="block">Schedules the execution of <b>Read Records</b> commands to read all SV logs.

 <p>Note: this method requires that the selected application is of type Store Value (file
 structure 20h).

 <p>The SV transaction logs are contained in two files with fixed identifiers:

 <ul>
   <li>The file whose SFI is 14h contains 1 record containing the unique reload log.
   <li>The file whose SFI is 15h contains 3 records containing the last three debit logs.
 </ul>

 <p>At the end of this reading operation, the data will be accessible in <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> in
 raw format via the standard commands for accessing read files or in the form of dedicated
 objects (see <a href="../card/CalypsoCard.html#getSvLoadLogRecord()"><code>CalypsoCard.getSvLoadLogRecord()</code></a> and <a href="../card/CalypsoCard.html#getSvDebitLogAllRecords()"><code>CalypsoCard.getSvDebitLogAllRecords()</code></a>).

 <p>See the methods <a href="../card/CalypsoCard.html#getSvBalance()"><code>CalypsoCard.getSvBalance()</code></a>, <a href="../card/CalypsoCard.html#getSvLoadLogRecord()"><code>CalypsoCard.getSvLoadLogRecord()</code></a>, <a href="../card/CalypsoCard.html#getSvDebitLogLastRecord()"><code>CalypsoCard.getSvDebitLogLastRecord()</code></a>, <a href="../card/CalypsoCard.html#getSvDebitLogAllRecords()"><code>CalypsoCard.getSvDebitLogAllRecords()</code></a>.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.UnsupportedOperationException</code> - If the SV feature is not available for this card.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareInvalidate()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareInvalidate</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareInvalidate()</pre>
<div class="block">Schedules the execution of a <b>Invalidate</b> command.

 <p>This command is usually executed within a secure session with the DEBIT key (depends on the
 access rights given to this command in the file structure of the card).</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - If the card is already invalidated.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareRehabilitate()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareRehabilitate</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareRehabilitate()</pre>
<div class="block">Schedules the execution of a <b>Rehabilitate</b> command.

 <p>This command is usually executed within a secure session with the PERSONALIZATION key
 (depends on the access rights given to this command in the file structure of the card).</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - If the card is not invalidated.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareReleaseCardChannel()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareReleaseCardChannel</h4>
<pre class="methodSignature">@Deprecated
<a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareReleaseCardChannel()</pre>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="CommonTransactionManager.html#processCommands(boolean)"><code>CommonTransactionManager.processCommands(boolean)</code></a> method instead.</div>
</div>
<div class="block">Requests the closing of the card channel.

 <p>If this command is called before a "process" command (except for processOpening) then the
 last transmission to the card will be associated with the indication CLOSE_AFTER in order to
 close the card channel.

 <p>Note: this command must imperatively be called at the end of any transaction, whether it
 ended normally or not.

 <p>In case the transaction was interrupted (exception), an additional invocation of
 processCardCommands must be made to effectively close the channel.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareEarlyMutualAuthentication()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareEarlyMutualAuthentication</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareEarlyMutualAuthentication()</pre>
<div class="block">Requests to mutually authenticate the card and the terminal before the secure session is
 closed.

 <p>This ensures the authenticity of the card before sending sensitive commands.

 <p>The use of this feature will penalize the execution time of the secure session and should
 therefore be used only for the case mentioned above. As a reminder, closing the secure session
 also performs a mutual authentication of the card and the terminal.

 <p>When it is needed, it is advised to use this command only once at the beginning of the
 secure session.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.UnsupportedOperationException</code> - The "Manage Secure Session" command is not available for
     this context (Card and/or SAM does not support the extended mode).</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.5.0</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="#prepareActivateEncryption()"><code>prepareActivateEncryption()</code></a>, 
<a href="#prepareDeactivateEncryption()"><code>prepareDeactivateEncryption()</code></a></dd>
</dl>
</li>
</ul>
<a id="prepareActivateEncryption()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareActivateEncryption</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareActivateEncryption()</pre>
<div class="block">Requests the encryption of all following commands.

 <p>This ensures data confidentiality and prevents man-in-the-middle attacks.

 <p>The use of data encryption is resource intensive and increases transaction times. It is
 therefore recommended to limit encryption to commands that require it.

 <p>Furthermore, if mutual authentication is also required, for performance reasons, it is
 advised to place the prepareEarlyMutualAuthentication and prepareActivateEncryption calls
 consecutively (in any order) for optimization purpose.

 <p>This command only makes sense in the context of a secure session.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.UnsupportedOperationException</code> - The "Manage Secure Session" command is not available for
     this context (Card and/or SAM does not support the extended mode).</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.5.0</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="#prepareDeactivateEncryption()"><code>prepareDeactivateEncryption()</code></a>, 
<a href="#prepareEarlyMutualAuthentication()"><code>prepareEarlyMutualAuthentication()</code></a></dd>
</dl>
</li>
</ul>
<a id="prepareDeactivateEncryption()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareDeactivateEncryption</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareDeactivateEncryption()</pre>
<div class="block">Requests to stop encryption for the following commands.

 <p>This restores the exchange operations with the card to its normal mode.

 <p>This command only makes sense in the context of a secure session in which encryption of
 commands has been previously requested.

 <p>Note: the <a href="#processClosing()"><code>processClosing()</code></a> method automatically stops the
 encryption.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.UnsupportedOperationException</code> - The "Manage Secure Session" command is not available for
     this context (Card and/or SAM does not support the extended mode).</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.5.0</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="#prepareActivateEncryption()"><code>prepareActivateEncryption()</code></a>, 
<a href="#prepareEarlyMutualAuthentication()"><code>prepareEarlyMutualAuthentication()</code></a>, 
<a href="#processClosing()"><code>processClosing()</code></a></dd>
</dl>
</li>
</ul>
<a id="processCardCommands()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>processCardCommands</h4>
<pre class="methodSignature">@Deprecated
<a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;processCardCommands()</pre>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="CommonTransactionManager.html#processCommands()"><code>CommonTransactionManager.processCommands()</code></a> instead. (will be soon removed)</div>
</div>
<div class="block">Process all previously prepared card commands outside or inside a Secure Session.

 <ul>
   <li>All APDUs resulting from prepared commands are grouped and sent to the card.
   <li>The <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> object is updated with the result of the executed commands.
   <li>If a secure session is opened, except in the case where reloading or debit SV operations
       have been prepared, the invocation of this method does not generate communication with
       the SAM. The data necessary for the calculation of the terminal signature are kept to be
       sent to the SAM at the time of the invocation of <a href="#processClosing()"><code>processClosing()</code></a>.<br>
       The card channel is kept open.
   <li>If no secure session is opened, the card channel is closed depending on whether or not
       prepareReleaseCardChannel has been called.
   <li>The card session buffer overflows are managed in the same way as in <a href="#processOpening(org.calypsonet.terminal.calypso.WriteAccessLevel)"><code>processOpening(org.calypsonet.terminal.calypso.WriteAccessLevel)</code></a>. For example, when the
       multiple session mode is enabled, the commands are separated in as many sessions as
       necessary to respect the capacity of the card buffer.
 </ul></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="ReaderIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">ReaderIOException</a></code> - If a communication error with the card reader or SAM reader occurs.</dd>
<dd><code><a href="CardIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">CardIOException</a></code> - If a communication error with the card occurs.</dd>
<dd><code><a href="SamIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">SamIOException</a></code> - If a communication error with the SAM occurs.</dd>
<dd><code><a href="InvalidSignatureException.html" title="class in org.calypsonet.terminal.calypso.transaction">InvalidSignatureException</a></code> - If a signature associated to a prepared signature
     verification SAM command is invalid.</dd>
<dd><code><a href="UnexpectedCommandStatusException.html" title="class in org.calypsonet.terminal.calypso.transaction">UnexpectedCommandStatusException</a></code> - If a command returns an unexpected status.</dd>
<dd><code><a href="InconsistentDataException.html" title="class in org.calypsonet.terminal.calypso.transaction">InconsistentDataException</a></code> - If inconsistent data have been detected.</dd>
<dd><code><a href="SessionBufferOverflowException.html" title="class in org.calypsonet.terminal.calypso.transaction">SessionBufferOverflowException</a></code> - If a secure session is open and multiple session mode is
     disabled and the session buffer capacity is not sufficient.</dd>
<dd><code><a href="CardSignatureNotVerifiableException.html" title="class in org.calypsonet.terminal.calypso.transaction">CardSignatureNotVerifiableException</a></code> - If a secure session is open and multiple session
     mode is enabled and an intermediate session is correctly closed but the SAM is no longer
     available to verify the card signature.</dd>
<dd><code><a href="InvalidCardSignatureException.html" title="class in org.calypsonet.terminal.calypso.transaction">InvalidCardSignatureException</a></code> - If a secure session is open and multiple session mode is
     enabled and an intermediate session is correctly closed but the card signature is
     incorrect.</dd>
<dd><code><a href="SelectFileException.html" title="class in org.calypsonet.terminal.calypso.transaction">SelectFileException</a></code> - If a "Select File" prepared card command indicated that the file
     was not found.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="processVerifyPin(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>processVerifyPin</h4>
<pre class="methodSignature">@Deprecated
<a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;processVerifyPin&#8203;(byte[]&nbsp;pin)</pre>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareVerifyPin(byte%5B%5D)"><code>prepareVerifyPin(byte[])</code></a> method instead.</div>
</div>
<div class="block">Performs a PIN verification, in order to authenticate the cardholder and/or unlock access to
 certain card files.

 <p>This command can be performed both in and out of a secure session. The PIN code can be
 transmitted in plain text or encrypted according to the parameter set in CardSecuritySetting
 (by default the transmission is encrypted).

 <p>If the execution is done out of session but an encrypted transmission is requested, then
 CardTransactionManager must be constructed with <a href="CardSecuritySetting.html" title="interface in org.calypsonet.terminal.calypso.transaction"><code>CardSecuritySetting</code></a>

 <p>If CardTransactionManager is constructed without <a href="CardSecuritySetting.html" title="interface in org.calypsonet.terminal.calypso.transaction"><code>CardSecuritySetting</code></a> the
 transmission in done in plain.

 <p>The card channel is closed if prepareReleaseCardChannel is called before this command.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>pin</code> - The PIN code value (4-byte long byte array).</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.UnsupportedOperationException</code> - If the PIN feature is not available for this card.</dd>
<dd><code>java.lang.IllegalArgumentException</code> - If the provided argument is out of range.</dd>
<dd><code>java.lang.IllegalStateException</code> - If commands have been prepared before invoking this process
     method.</dd>
<dd><code><a href="ReaderIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">ReaderIOException</a></code> - If a communication error with the card reader or SAM reader occurs.</dd>
<dd><code><a href="CardIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">CardIOException</a></code> - If a communication error with the card occurs.</dd>
<dd><code><a href="SamIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">SamIOException</a></code> - If a communication error with the SAM occurs.</dd>
<dd><code><a href="UnexpectedCommandStatusException.html" title="class in org.calypsonet.terminal.calypso.transaction">UnexpectedCommandStatusException</a></code> - If a command returns an unexpected status.</dd>
<dd><code><a href="InconsistentDataException.html" title="class in org.calypsonet.terminal.calypso.transaction">InconsistentDataException</a></code> - If inconsistent data have been detected.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareVerifyPin(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareVerifyPin</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareVerifyPin&#8203;(byte[]&nbsp;pin)</pre>
<div class="block">Schedules the execution of a PIN verification command in order to authenticate the cardholder
 and/or unlock access to certain card files.

 <p>This command can be performed both in and out of a secure session. The PIN code can be
 transmitted in plain text or encrypted according to the parameter set in <a href="CardSecuritySetting.html" title="interface in org.calypsonet.terminal.calypso.transaction"><code>CardSecuritySetting</code></a>. By default, the transmission is encrypted.

 <p>If the execution is done out of session but an encrypted transmission is requested, then
 CardTransactionManager must be constructed with <a href="CardSecuritySetting.html" title="interface in org.calypsonet.terminal.calypso.transaction"><code>CardSecuritySetting</code></a>.

 <p>If CardTransactionManager is constructed without <a href="CardSecuritySetting.html" title="interface in org.calypsonet.terminal.calypso.transaction"><code>CardSecuritySetting</code></a> the
 transmission in done in plain.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>pin</code> - The PIN code value (4-byte long byte array).</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.UnsupportedOperationException</code> - If the PIN feature is not available for this card.</dd>
<dd><code>java.lang.IllegalArgumentException</code> - If the provided argument is out of range.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.6.0</dd>
</dl>
</li>
</ul>
<a id="processChangePin(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>processChangePin</h4>
<pre class="methodSignature">@Deprecated
<a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;processChangePin&#8203;(byte[]&nbsp;newPin)</pre>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareChangePin(byte%5B%5D)"><code>prepareChangePin(byte[])</code></a> method instead.</div>
</div>
<div class="block">Replaces the current PIN with the new value provided.

 <p>This command can be performed only out of a secure session. The new PIN code can be
 transmitted in plain text or encrypted according to the parameter set in CardSecuritySetting
 (by default the transmission is encrypted).

 <p>When the PIN is transmitted plain, this command must be preceded by a successful Verify PIN
 command (see <a href="#processVerifyPin(byte%5B%5D)"><code>processVerifyPin(byte[])</code></a>).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>newPin</code> - The new PIN code value (4-byte long byte array).</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.UnsupportedOperationException</code> - If the PIN feature is not available for this card.</dd>
<dd><code>java.lang.IllegalArgumentException</code> - If the provided argument is out of range.</dd>
<dd><code>java.lang.IllegalStateException</code> - If the command is executed while a secure session is open.</dd>
<dd><code><a href="ReaderIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">ReaderIOException</a></code> - If a communication error with the card reader or SAM reader occurs.</dd>
<dd><code><a href="CardIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">CardIOException</a></code> - If a communication error with the card occurs.</dd>
<dd><code><a href="SamIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">SamIOException</a></code> - If a communication error with the SAM occurs.</dd>
<dd><code><a href="UnexpectedCommandStatusException.html" title="class in org.calypsonet.terminal.calypso.transaction">UnexpectedCommandStatusException</a></code> - If a command returns an unexpected status.</dd>
<dd><code><a href="InconsistentDataException.html" title="class in org.calypsonet.terminal.calypso.transaction">InconsistentDataException</a></code> - If inconsistent data have been detected.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareChangePin(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareChangePin</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareChangePin&#8203;(byte[]&nbsp;newPin)</pre>
<div class="block">Schedules the execution of a PIN modification command to replace the current PIN with the new
 value provided.

 <p>This command can be performed only out of a secure session. The new PIN code can be
 transmitted in plain text or encrypted according to the parameter set in <a href="CardSecuritySetting.html" title="interface in org.calypsonet.terminal.calypso.transaction"><code>CardSecuritySetting</code></a>. By default, the transmission is encrypted.

 <p>When the PIN is transmitted plain, this command must be preceded by a successful Verify PIN
 command (see <a href="#prepareVerifyPin(byte%5B%5D)"><code>prepareVerifyPin(byte[])</code></a>).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>newPin</code> - The new PIN code value (4-byte long byte array).</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.UnsupportedOperationException</code> - If the PIN feature is not available for this card.</dd>
<dd><code>java.lang.IllegalArgumentException</code> - If the provided argument is out of range.</dd>
<dd><code>java.lang.IllegalStateException</code> - If the command is executed while a secure session is open.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.6.0</dd>
</dl>
</li>
</ul>
<a id="processChangeKey(int,byte,byte,byte,byte)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>processChangeKey</h4>
<pre class="methodSignature">@Deprecated
<a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;processChangeKey&#8203;(int&nbsp;keyIndex,
                                        byte&nbsp;newKif,
                                        byte&nbsp;newKvc,
                                        byte&nbsp;issuerKif,
                                        byte&nbsp;issuerKvc)</pre>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareChangeKey(int,byte,byte,byte,byte)"><code>prepareChangeKey(int, byte, byte, byte, byte)</code></a> method instead.</div>
</div>
<div class="block">Replaces one of the current card keys with another key present in the SAM.

 <p>This command can be performed only out of a secure session.

 <p>The change key process transfers the key from the SAM to the card. The new key is
 diversified by the SAM from a primary key and encrypted using the indicated issuer key to
 secure the transfer to the card. All provided KIFs and KVCs must be present in the SAM.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>keyIndex</code> - The index of the key to be replaced (1 for the issuer key, 2 for the load key,
     3 for the debit key).</dd>
<dd><code>newKif</code> - The KIF of the new key.</dd>
<dd><code>newKvc</code> - The KVC of the new key.</dd>
<dd><code>issuerKif</code> - The KIF of the current card's issuer key.</dd>
<dd><code>issuerKvc</code> - The KVC of the current card's issuer key.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.UnsupportedOperationException</code> - If the Change Key command is not available for this card.</dd>
<dd><code>java.lang.IllegalArgumentException</code> - If the provided key index is out of range.</dd>
<dd><code>java.lang.IllegalStateException</code> - If the command is executed while a secure session is open.</dd>
<dd><code><a href="ReaderIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">ReaderIOException</a></code> - If a communication error with the card reader or SAM reader occurs.</dd>
<dd><code><a href="CardIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">CardIOException</a></code> - If a communication error with the card occurs.</dd>
<dd><code><a href="SamIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">SamIOException</a></code> - If a communication error with the SAM occurs.</dd>
<dd><code><a href="UnexpectedCommandStatusException.html" title="class in org.calypsonet.terminal.calypso.transaction">UnexpectedCommandStatusException</a></code> - If a command returns an unexpected status.</dd>
<dd><code><a href="InconsistentDataException.html" title="class in org.calypsonet.terminal.calypso.transaction">InconsistentDataException</a></code> - If inconsistent data have been detected.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.1.0</dd>
</dl>
</li>
</ul>
<a id="prepareChangeKey(int,byte,byte,byte,byte)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareChangeKey</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareChangeKey&#8203;(int&nbsp;keyIndex,
                                        byte&nbsp;newKif,
                                        byte&nbsp;newKvc,
                                        byte&nbsp;issuerKif,
                                        byte&nbsp;issuerKvc)</pre>
<div class="block">Schedules the execution of a key loading command to replace one of the current card keys with
 another key present in the SAM.

 <p>This command can be performed only out of a secure session.

 <p>The change key process transfers the key from the SAM to the card. The new key is
 diversified by the SAM from a primary key and encrypted using the indicated issuer key to
 secure the transfer to the card. All provided KIFs and KVCs must be present in the SAM.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>keyIndex</code> - The index of the key to be replaced (1 for the issuer key, 2 for the load key,
     3 for the debit key).</dd>
<dd><code>newKif</code> - The KIF of the new key.</dd>
<dd><code>newKvc</code> - The KVC of the new key.</dd>
<dd><code>issuerKif</code> - The KIF of the current card's issuer key.</dd>
<dd><code>issuerKvc</code> - The KVC of the current card's issuer key.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.UnsupportedOperationException</code> - If the Change Key command is not available for this card.</dd>
<dd><code>java.lang.IllegalArgumentException</code> - If the provided key index is out of range.</dd>
<dd><code>java.lang.IllegalStateException</code> - If the command is executed while a secure session is open.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.6.0</dd>
</dl>
</li>
</ul>
<a id="processOpening(org.calypsonet.terminal.calypso.WriteAccessLevel)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>processOpening</h4>
<pre class="methodSignature">@Deprecated
<a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;processOpening&#8203;(<a href="../WriteAccessLevel.html" title="enum in org.calypsonet.terminal.calypso">WriteAccessLevel</a>&nbsp;writeAccessLevel)</pre>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareOpenSecureSession(org.calypsonet.terminal.calypso.WriteAccessLevel)"><code>prepareOpenSecureSession(WriteAccessLevel)</code></a> method instead.</div>
</div>
<div class="block">Opens a Calypso Secure Session and then executes all previously prepared commands.

 <p>It is the starting point of the sequence:

 <ul>
   <li><code>processOpening(WriteAccessLevel)</code>
   <li>[...]
   <li>[<a href="CommonTransactionManager.html#processCommands()"><code>CommonTransactionManager.processCommands()</code></a>]
   <li>[...]
   <li>[<a href="CommonTransactionManager.html#processCommands()"><code>CommonTransactionManager.processCommands()</code></a>]
   <li>[...]
   <li><a href="#processClosing()"><code>processClosing()</code></a>
 </ul>

 <p>Each of the steps in this sequence may or may not be preceded by the preparation of one or
 more commands and ends with an update of the <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> object provided when
 CardTransactionManager was created.

 <p>As a prerequisite for invoking this method, since the Calypso Secure Session involves the
 use of a SAM, the CardTransactionManager must have been built in secure mode, i.e. the
 constructor used must be the one expecting a reference to a valid <a href="CardSecuritySetting.html" title="interface in org.calypsonet.terminal.calypso.transaction"><code>CardSecuritySetting</code></a>
 object, otherwise a <code>IllegalStateException</code> is raised.

 <p>The secure session is opened with the <a href="../WriteAccessLevel.html" title="enum in org.calypsonet.terminal.calypso"><code>WriteAccessLevel</code></a> passed as an argument
 depending on whether it is a personalization, reload or debit transaction profile.

 <p>The possible overflow of the internal session buffer of the card is managed in two ways
 depending on the setting chosen in <a href="CardSecuritySetting.html" title="interface in org.calypsonet.terminal.calypso.transaction"><code>CardSecuritySetting</code></a>.

 <ul>
   <li>If the session was opened with the default atomic mode and the previously prepared
       commands will cause the buffer to be exceeded, then an <a href="SessionBufferOverflowException.html" title="class in org.calypsonet.terminal.calypso.transaction"><code>SessionBufferOverflowException</code></a> is raised and no transmission to the card is made. <br>
   <li>If the session was opened with the multiple session mode and the buffer is to be exceeded
       then a split into several secure sessions is performed automatically. However, regardless
       of the number of intermediate sessions performed, a secure session is opened at the end
       of the execution of this method.
 </ul>

 <p>Be aware that in the "MULTIPLE" case we lose the benefit of the atomicity of the secure
 session.

 <p><b>Card and SAM exchanges in detail</b>

 <p>When executing this method, communications with the card and the SAM are (in that order) :

 <ul>
   <li>Sending the card diversifier (Calypso card serial number) to the SAM and receiving the
       terminal challenge
   <li>Grouped sending to the card of
       <ul>
         <li>the open secure session command including the challenge terminal.
         <li>all previously prepared commands
       </ul>
   <li>Receiving grouped responses and updating <a href="../card/CalypsoCard.html" title="interface in org.calypsonet.terminal.calypso.card"><code>CalypsoCard</code></a> with the collected data.
 </ul>

 <p><b>Other operations carried out</b>

 <ul>
   <li>The card KIF, KVC and card challenge received in response to the open secure session
       command are kept for a later initialization of the session's digest (see <a href="#processClosing()"><code>processClosing()</code></a>).
   <li>All data received in response to the open secure session command and the responses to the
       prepared commands are also stored for later calculation of the digest.
   <li>If a list of authorized KVCs has been defined in <a href="CardSecuritySetting.html" title="interface in org.calypsonet.terminal.calypso.transaction"><code>CardSecuritySetting</code></a> and the KVC
       of the card does not belong to this list then a <a href="UnauthorizedKeyException.html" title="class in org.calypsonet.terminal.calypso.transaction"><code>UnauthorizedKeyException</code></a> is
       thrown.
 </ul>

 <p>All unexpected results (communication errors, data or security errors, etc. are notified to
 the calling application through dedicated exceptions.

 <p><i>Note: to understand in detail how the secure session works please refer to the card
 specification documents.</i></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>writeAccessLevel</code> - An <a href="../WriteAccessLevel.html" title="enum in org.calypsonet.terminal.calypso"><code>WriteAccessLevel</code></a> enum entry.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If the provided argument is null.</dd>
<dd><code>java.lang.IllegalStateException</code> - If no <a href="CardSecuritySetting.html" title="interface in org.calypsonet.terminal.calypso.transaction"><code>CardSecuritySetting</code></a> is available.</dd>
<dd><code><a href="ReaderIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">ReaderIOException</a></code> - If a communication error with the card reader or SAM reader occurs.</dd>
<dd><code><a href="CardIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">CardIOException</a></code> - If a communication error with the card occurs.</dd>
<dd><code><a href="SamIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">SamIOException</a></code> - If a communication error with the SAM occurs.</dd>
<dd><code><a href="InvalidSignatureException.html" title="class in org.calypsonet.terminal.calypso.transaction">InvalidSignatureException</a></code> - If a signature associated to a prepared signature
     verification SAM command is invalid.</dd>
<dd><code><a href="UnexpectedCommandStatusException.html" title="class in org.calypsonet.terminal.calypso.transaction">UnexpectedCommandStatusException</a></code> - If a command returns an unexpected status.</dd>
<dd><code><a href="InconsistentDataException.html" title="class in org.calypsonet.terminal.calypso.transaction">InconsistentDataException</a></code> - If inconsistent data have been detected.</dd>
<dd><code><a href="UnauthorizedKeyException.html" title="class in org.calypsonet.terminal.calypso.transaction">UnauthorizedKeyException</a></code> - If the card requires an unauthorized session key.</dd>
<dd><code><a href="SessionBufferOverflowException.html" title="class in org.calypsonet.terminal.calypso.transaction">SessionBufferOverflowException</a></code> - If multiple session mode is disabled and the session
     buffer capacity is not sufficient.</dd>
<dd><code><a href="CardSignatureNotVerifiableException.html" title="class in org.calypsonet.terminal.calypso.transaction">CardSignatureNotVerifiableException</a></code> - If multiple session mode is enabled and an
     intermediate session is correctly closed but the SAM is no longer available to verify the
     card signature.</dd>
<dd><code><a href="InvalidCardSignatureException.html" title="class in org.calypsonet.terminal.calypso.transaction">InvalidCardSignatureException</a></code> - If multiple session mode is enabled and an intermediate
     session is correctly closed but the card signature is incorrect.</dd>
<dd><code><a href="SelectFileException.html" title="class in org.calypsonet.terminal.calypso.transaction">SelectFileException</a></code> - If a "Select File" prepared card command indicated that the file
     was not found.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareOpenSecureSession(org.calypsonet.terminal.calypso.WriteAccessLevel)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareOpenSecureSession</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareOpenSecureSession&#8203;(<a href="../WriteAccessLevel.html" title="enum in org.calypsonet.terminal.calypso">WriteAccessLevel</a>&nbsp;writeAccessLevel)</pre>
<div class="block">Schedules the execution of a secure session opening command.

 <p>This feature is only available for a transaction initialized in secure mode.

 <p>The secure session will be opened with the provided <a href="../WriteAccessLevel.html" title="enum in org.calypsonet.terminal.calypso"><code>WriteAccessLevel</code></a> depending on
 whether it is a personalization, reload or debit transaction profile.

 <p>Note that if the next prepared command is a "Read One Record" or "Read One Or More
 Counters", then it will by default be merged with the "Open Secure Session" command for
 optimization purposes.

 <p>This mechanism may in some cases be incompatible with the security constraints and can be
 disabled via the <a href="CardSecuritySetting.html#disableReadOnSessionOpening()"><code>CardSecuritySetting.disableReadOnSessionOpening()</code></a> method.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>writeAccessLevel</code> - The write access level to be used.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - If the provided argument is null.</dd>
<dd><code>java.lang.IllegalStateException</code> - In the following cases:
     <ul>
       <li>No <a href="CardSecuritySetting.html" title="interface in org.calypsonet.terminal.calypso.transaction"><code>CardSecuritySetting</code></a> is available
       <li>A secure session opening is already prepared
       <li>A secure session is already opened
     </ul></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.6.0</dd>
</dl>
</li>
</ul>
<a id="processClosing()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>processClosing</h4>
<pre class="methodSignature">@Deprecated
<a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;processClosing()</pre>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareCloseSecureSession()"><code>prepareCloseSecureSession()</code></a> method instead.</div>
</div>
<div class="block">Terminates the Secure Session sequence started with <a href="#processOpening(org.calypsonet.terminal.calypso.WriteAccessLevel)"><code>processOpening(WriteAccessLevel)</code></a>.

 <p><b>Nominal case</b>

 <p>The previously prepared commands are integrated into the calculation of the session digest
 by the SAM before execution by the card by anticipating their responses.

 <p>Thus, the session closing command containing the terminal signature is integrated into the
 same APDU group sent to the card via a final card request.

 <p>Upon reception of the response from the card, the signature of the card is verified with the
 SAM.

 <p>If the method terminates normally, it means that the secure session closing and all related
 security checks have been successful; conversely, if one of these operations fails, an
 exception is raised.

 <p><b>Stored Value</b>

 <p>If the SV counter was debited or reloaded during the session, an additional verification
 specific to the SV is performed by the SAM.

 <p><b>Ratification</b>

 <p>A ratification command is added after the close secure session command when the
 communication is done in a contactless mode.

 <p>The logical channel is closed or left open depending on whether the <a href="#prepareReleaseCardChannel()"><code>prepareReleaseCardChannel()</code></a> method has been called before or not.

 <p><b>Card and SAM exchanges in detail</b>

 <ul>
   <li>All the data exchanged with the card so far, to which are added the last prepared orders
       and their anticipated answers, are sent to the SAM for the calculation of the session
       digest. The terminal signature calculation request is also integrated in the same group
       of SAM Apdu.
   <li>All previously prepared commands are sent to the card along with the session closing
       command and possibly the ratification command within a single card request.
   <li>The responses received from the card are integrated into CalypsoCard. <br>
       Note: the reception of the answers of this final card request from the card is tolerant
       to the non-reception of the answer to the ratification order.
   <li>The data received from the card in response to the logout (card session signature and
       possibly SV signature) are sent to the SAM for verification.
 </ul></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - If no session is open.</dd>
<dd><code><a href="ReaderIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">ReaderIOException</a></code> - If a communication error with the card reader or SAM reader occurs.</dd>
<dd><code><a href="CardIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">CardIOException</a></code> - If a communication error with the card occurs.</dd>
<dd><code><a href="SamIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">SamIOException</a></code> - If a communication error with the SAM occurs.</dd>
<dd><code><a href="InvalidSignatureException.html" title="class in org.calypsonet.terminal.calypso.transaction">InvalidSignatureException</a></code> - If a signature associated to a prepared signature
     verification SAM command is invalid.</dd>
<dd><code><a href="UnexpectedCommandStatusException.html" title="class in org.calypsonet.terminal.calypso.transaction">UnexpectedCommandStatusException</a></code> - If a command returns an unexpected status.</dd>
<dd><code><a href="InconsistentDataException.html" title="class in org.calypsonet.terminal.calypso.transaction">InconsistentDataException</a></code> - If inconsistent data have been detected.</dd>
<dd><code><a href="SessionBufferOverflowException.html" title="class in org.calypsonet.terminal.calypso.transaction">SessionBufferOverflowException</a></code> - If multiple session mode is disabled and the session
     buffer capacity is not sufficient.</dd>
<dd><code><a href="CardSignatureNotVerifiableException.html" title="class in org.calypsonet.terminal.calypso.transaction">CardSignatureNotVerifiableException</a></code> - If session is correctly closed but the SAM is no
     longer available to verify the card signature.</dd>
<dd><code><a href="InvalidCardSignatureException.html" title="class in org.calypsonet.terminal.calypso.transaction">InvalidCardSignatureException</a></code> - If session is correctly closed but the card signature is
     incorrect.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareCloseSecureSession()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareCloseSecureSession</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareCloseSecureSession()</pre>
<div class="block">Schedules the execution of a secure session closing command.

 <p>The ratification mechanism is disabled by default but can be enabled via the <a href="CardSecuritySetting.html#enableRatificationMechanism()"><code>CardSecuritySetting.enableRatificationMechanism()</code></a> method.

 <p>In this case, a ratification command is added after the "Close Secure Session" command when
 the communication is done in contactless mode.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - In the following cases:
     <ul>
       <li>No secure session is opened and no secure session opening is prepared
       <li>A secure session closing is already prepared
       <li>A secure session canceling is prepared
     </ul></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.6.0</dd>
</dl>
</li>
</ul>
<a id="processCancel()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>processCancel</h4>
<pre class="methodSignature">@Deprecated
<a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;processCancel()</pre>
<div class="deprecationBlock"><span class="deprecatedLabel">Deprecated.</span>
<div class="deprecationComment">Use <a href="#prepareCancelSecureSession()"><code>prepareCancelSecureSession()</code></a> method instead.</div>
</div>
<div class="block">Aborts a Secure Session.

 <p>Send the appropriate command to the card

 <p>Clean up internal data and status.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - If no session is open.</dd>
<dd><code><a href="ReaderIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">ReaderIOException</a></code> - If a communication error with the card reader occurs.</dd>
<dd><code><a href="CardIOException.html" title="class in org.calypsonet.terminal.calypso.transaction">CardIOException</a></code> - If a communication error with the card occurs.</dd>
<dd><code><a href="UnexpectedCommandStatusException.html" title="class in org.calypsonet.terminal.calypso.transaction">UnexpectedCommandStatusException</a></code> - If the command returns an unexpected status.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
</dl>
</li>
</ul>
<a id="prepareCancelSecureSession()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>prepareCancelSecureSession</h4>
<pre class="methodSignature"><a href="CardTransactionManager.html" title="interface in org.calypsonet.terminal.calypso.transaction">CardTransactionManager</a>&nbsp;prepareCancelSecureSession()</pre>
<div class="block">Schedules the execution of a secure session canceling command.

 <p>This command will be executed in safe mode and will not raise any exceptions.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The current instance.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.6.0</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CardTransactionManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage">Copyright © Calypso Networks Association https://calypsonet.org/</div>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</body>
</html>
